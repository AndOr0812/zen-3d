!function(){function t(t){return"string"==typeof t?(t=t.toUpperCase(),i[t]||t.charCodeAt(0)):t}function e(e){var i,s,n;for(n=(s=(e=t(e)).toString(16).toUpperCase()).length,i=0;i<4-n;i++)s="0"+s;return"U+"+s}var i={TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,WIN:91},s=function(t,e){e=e||{},this._element=null,this._keyDownHandler=this._handleKeyDown.bind(this),this._keyUpHandler=this._handleKeyUp.bind(this),this._keyPressHandler=this._handleKeyPress.bind(this),this._keymap={},this._lastmap={},t&&this.attach(t),this.preventDefault=e.preventDefault||!1,this.stopPropagation=e.stopPropagation||!1};s.prototype.attach=function(t){this._element&&this.detach(),this._element=t,this._element.addEventListener("keydown",this._keyDownHandler,!1),this._element.addEventListener("keypress",this._keyPressHandler,!1),this._element.addEventListener("keyup",this._keyUpHandler,!1)},s.prototype.detach=function(){this._element.removeEventListener("keydown",this._keyDownHandler),this._element.removeEventListener("keypress",this._keyPressHandler),this._element.removeEventListener("keyup",this._keyUpHandler),this._element=null},s.prototype._handleKeyDown=function(t){var i=e(t.keyCode||t.charCode);this._keymap[i]=!0,this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation()},s.prototype._handleKeyUp=function(t){var i=e(t.keyCode||t.charCode);delete this._keymap[i],this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation()},s.prototype._handleKeyPress=function(t){e(t.keyCode||t.charCode);this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation()},s.prototype.update=function(){var t;for(t in this._lastmap)delete this._lastmap[t];for(t in this._keymap)this._keymap.hasOwnProperty(t)&&(this._lastmap[t]=this._keymap[t])},s.prototype.isPressed=function(t){var i=e(t);return!!this._keymap[i]},s.prototype.wasPressed=function(t){var i=e(t);return!!this._keymap[i]&&!this._lastmap[i]},s.prototype.wasReleased=function(t){var i=e(keyCode);return!this._keymap[i]&&!!this._lastmap[i]},zen3d.Keyboard=s}(),function(){var t=function(t){this.position={x:0,y:0},this.wheel=0,this._upHandler=this._handleUp.bind(this),this._downHandler=this._handleDown.bind(this),this._moveHandler=this._handleMove.bind(this),this._wheelHandler=this._handleWheel.bind(this),this._contextMenuHandler=function(t){t.preventDefault()},this._buttons=[!1,!1,!1],this._lastbuttons=[!1,!1,!1],t&&this.attach(t)};t.prototype.disableContextMenu=function(){this._element&&this._element.addEventListener("contextmenu",this._contextMenuHandler)},t.prototype.enableContextMenu=function(){this._element&&this._element.removeEventListener("contextmenu",this._contextMenuHandler)},t.prototype.attach=function(t){this._element&&this.detach(),this._element=t,this._element.addEventListener("mouseup",this._upHandler,!1),this._element.addEventListener("mousedown",this._downHandler,!1),this._element.addEventListener("mousemove",this._moveHandler,!1),this._element.addEventListener("mousewheel",this._wheelHandler,!1),this._element.addEventListener("DOMMouseScroll",this._wheelHandler,!1)},t.prototype.detach=function(){this._element&&(this._element.removeEventListener("mouseup",this._upHandler,!1),this._element.removeEventListener("mousedown",this._downHandler,!1),this._element.removeEventListener("mousemove",this._moveHandler,!1),this._element.removeEventListener("mousewheel",this._wheelHandler,!1),this._element.removeEventListener("DOMMouseScroll",this._wheelHandler,!1),this._element=null)},t.prototype.update=function(){this._lastbuttons[0]=this._buttons[0],this._lastbuttons[1]=this._buttons[1],this._lastbuttons[2]=this._buttons[2],this.wheel=0},t.prototype.isPressed=function(t){return this._buttons[t]},t.prototype.wasPressed=function(t){return this._buttons[t]&&!this._lastbuttons[t]},t.prototype.wasReleased=function(t){return!this._buttons[t]&&this._lastbuttons[t]},t.prototype._handleUp=function(t){this._buttons[t.button]=!1},t.prototype._handleDown=function(t){this._buttons[t.button]=!0},t.prototype._handleMove=function(t){this.position.x=t.clientX,this.position.y=t.clientY},t.prototype._handleWheel=function(t){t.detail?this.wheel=-1*t.detail:t.wheelDelta?this.wheel=t.wheelDelta/120:this.wheel=0},zen3d.Mouse=t}(),function(){var t={BEGAN:"began",MOVED:"moved",STATIONARY:"stationary",ENDED:"ended",CANCELED:"canceled"};zen3d.TouchPhase=t;var e=function(){this.altitudeAngle=Math.PI/2,this.azimuthAngle=0,this.deltaPosition={x:0,y:0},this.fingerId=0,this.maximumPossiblePressure=1,this.phase="",this.position={x:0,y:0},this.pressure=1,this.radius={x:0,y:0},this.type="Direct"};e.prototype.set=function(e,i){this.altitudeAngle=e.rotationAngle,this.azimuthAngle=e.rotationAngle,i===t.BEGAN||i===t.STATIONARY?(this.deltaPosition.x=0,this.deltaPosition.y=0):(this.deltaPosition.x=e.clientX-this.position.x,this.deltaPosition.y=e.clientY-this.position.y),this.fingerId=e.identifier,this.phase=i,this.position.x=e.clientX,this.position.y=e.clientY,this.pressure=e.force,this.radius.x=e.radiusX,this.radius.y=e.radiusY},e._pointPool=[],e.create=function(){return this._pointPool.pop()||new e},e.release=function(t){this._pointPool.push(t)},zen3d.TouchPoint=e;var i=function(t){this._touchesMap={},this._touches=[],this.touchCount=0,this._startHandler=this._handleTouchStart.bind(this),this._endHandler=this._handleTouchEnd.bind(this),this._moveHandler=this._handleTouchMove.bind(this),this._cancelHandler=this._handleTouchCancel.bind(this),t&&this.attach(t)};i.prototype.attach=function(t){this._element&&this.detach(),this._element=t,this._element.addEventListener("touchstart",this._startHandler,!1),this._element.addEventListener("touchend",this._endHandler,!1),this._element.addEventListener("touchmove",this._moveHandler,!1),this._element.addEventListener("touchcancel",this._cancelHandler,!1)},i.prototype.detach=function(){this._element&&(this._element.removeEventListener("touchstart",this._startHandler,!1),this._element.removeEventListener("touchend",this._endHandler,!1),this._element.removeEventListener("touchmove",this._moveHandler,!1),this._element.removeEventListener("touchcancel",this._cancelHandler,!1)),this._element=null},i.prototype.update=function(){for(var e in this._touchesMap){var i=this._touchesMap[e];if(i.phase===t.BEGAN&&(i.phase=t.STATIONARY),i.phase===t.ENDED||i.phase===t.CANCELED){delete this._touchesMap[e];var s=this._touches.indexOf(i);s>-1&&this._touches.splice(s,1),this.touchCount--}}},i.prototype.getTouch=function(t){return this._touches[t]},i.prototype._getTouch=function(t){var i=this._touchesMap[t];return i||(i=e.create(),this._touchesMap[t]=i,this._touches.push(i),this.touchCount++),i},i.prototype._handleTouchStart=function(e){for(var i=0;i<e.changedTouches.length;i++){var s=e.changedTouches[i],n=s.identifier;this._getTouch(n).set(s,t.BEGAN)}},i.prototype._handleTouchEnd=function(e){for(var i=0;i<e.changedTouches.length;i++){var s=e.changedTouches[i],n=s.identifier;this._getTouch(n).set(s,t.ENDED)}},i.prototype._handleTouchMove=function(e){e.preventDefault();for(var i=0;i<e.changedTouches.length;i++){var s=e.changedTouches[i],n=s.identifier;this._getTouch(n).set(s,t.MOVED)}},i.prototype._handleTouchCancel=function(e){for(var i=0;i<e.changedTouches.length;i++){var s=e.changedTouches[i],n=s.identifier;this._getTouch(n).set(s,t.CANCELED)}},zen3d.Touch=i}(),function(){var t=function(t,e){this.camera=t,this.lookAtPoint=e,this.up=new zen3d.Vector3(0,1,0),this.distance=100,this._panAngle=0,this._panRad=0,this.minPanAngle=-1/0,this.maxPanAngle=1/0,this._tiltAngle=0,this._tiltRad=0,this.minTileAngle=-90,this.maxTileAngle=90,this.bindMouse=void 0,this._lastMouseX,this._lastMouseY,this._mouseDown=!1,this.bindTouch=void 0,this._lastTouchX,this._lastTouchY,this._fingerTwo=!1,this._lastDistance,this._lastPosition=new zen3d.Vector3,this._lastQuaternion=new zen3d.Quaternion};Object.defineProperties(t.prototype,{panAngle:{get:function(){return this._panAngle},set:function(t){this._panAngle=Math.max(this.minPanAngle,Math.min(this.maxPanAngle,t)),this._panRad=this._panAngle*Math.PI/180}},tiltAngle:{get:function(){return this._tiltAngle},set:function(t){this._tiltAngle=Math.max(this.minTileAngle,Math.min(this.maxTileAngle,t)),this._tiltRad=this._tiltAngle*Math.PI/180}}});t.prototype.update=function(){this.bindMouse&&this._updateMouse(),this.bindTouch&&this._updateTouch();var t=this.distance*Math.sin(this._panRad)*Math.cos(this._tiltRad),e=this.distance*Math.sin(this._tiltRad),i=this.distance*Math.cos(this._panRad)*Math.cos(this._tiltRad),s=this.camera,n=this.lookAtPoint;return s.position.set(t+n.x,e+n.y,i+n.z),s.lookAt(n,this.up),(this._lastPosition.distanceToSquared(s.position)>1e-6||8*(1-this._lastQuaternion.dot(s.quaternion))>1e-6)&&(this._lastPosition.copy(s.position),this._lastQuaternion.copy(s.quaternion),!0)},t.prototype._updateMouse=function(){var t=this.bindMouse;if(t.isPressed(0))if(this._mouseDown&&void 0!=this._lastMouseX&&void 0!=this._lastMouseY){var e=t.position.x-this._lastMouseX,i=t.position.y-this._lastMouseY;this.panAngle-=e,this.tiltAngle+=i,this._lastMouseX=t.position.x,this._lastMouseY=t.position.y}else this._mouseDown=!0,this._lastMouseX=t.position.x,this._lastMouseY=t.position.y;else t.wasReleased(0)&&(this._mouseDown=!1);this.distance=Math.max(this.distance-2*t.wheel,1)};var e=new zen3d.Vector2,i=new zen3d.Vector2;t.prototype._updateTouch=function(t){if((t=this.bindTouch).touchCount>0)if(1==t.touchCount){var s=t.getTouch(0);if(s.phase==zen3d.TouchPhase.BEGAN||this._fingerTwo||void 0==this._lastTouchX||void 0==this._lastTouchY)this._lastTouchX=s.position.x,this._lastTouchY=s.position.y;else{var n=s.position.x-this._lastTouchX,o=s.position.y-this._lastTouchY;this.panAngle-=.5*n,this.tiltAngle+=.5*o,this._lastTouchX=s.position.x,this._lastTouchY=s.position.y}this._fingerTwo=!1}else if(2==t.touchCount){var h=t.getTouch(0),a=t.getTouch(1);if(h.phase==zen3d.TouchPhase.BEGAN||a.phase==zen3d.TouchPhase.BEGAN||0==this._fingerTwo||void 0==this._lastDistance)e.set(h.position.x,h.position.y),i.set(a.position.x,a.position.y),this._lastDistance=e.distanceTo(i);else{e.set(h.position.x,h.position.y),i.set(a.position.x,a.position.y);var r=e.distanceTo(i),l=r-this._lastDistance;this.distance=Math.max(this.distance-l,1),this._lastDistance=r}this._fingerTwo=!0}else this._fingerTwo=!1},zen3d.HoverController=t}(),function(){var t=function(t){this.camera=t,this.camera.euler.order="YXZ",this.bindKeyboard=void 0,this.bindMouse=void 0,this._lastMouseX,this._lastMouseY,this._mouseDown=!1,this._lastPosition=new zen3d.Vector3,this._lastQuaternion=new zen3d.Quaternion};t.prototype.update=function(){this.bindKeyboard&&this.keyboardUpdate(),this.bindMouse&&this.mouseUpdate();var t=this.camera;return(this._lastPosition.distanceToSquared(t.position)>1e-6||8*(1-this._lastQuaternion.dot(t.quaternion))>1e-6)&&(this._lastPosition.copy(t.position),this._lastQuaternion.copy(t.quaternion),!0)};var e=new zen3d.Vector3,i=new zen3d.Vector3,s=new zen3d.Vector3;t.prototype.keyboardUpdate=function(){var t=this.bindKeyboard;e.set(0,0,-1).applyQuaternion(this.camera.quaternion),i.set(0,1,0).applyQuaternion(this.camera.quaternion),s.set(1,0,0).applyQuaternion(this.camera.quaternion),t.isPressed("W")&&this.camera.position.add(e),t.isPressed("A")&&this.camera.position.sub(s),t.isPressed("S")&&this.camera.position.sub(e),t.isPressed("D")&&this.camera.position.add(s),t.isPressed("E")&&this.camera.position.add(i),t.isPressed("Q")&&this.camera.position.sub(i)},t.prototype.mouseUpdate=function(){var t=this.bindMouse;if(t.isPressed(0))if(this._mouseDown&&void 0!=this._lastMouseX&&void 0!=this._lastMouseY){var i=t.position.x-this._lastMouseX,s=t.position.y-this._lastMouseY;this.camera.euler.x-=.01*s,this.camera.euler.y-=.01*i,this._lastMouseX=t.position.x,this._lastMouseY=t.position.y}else this._mouseDown=!0,this._lastMouseX=t.position.x,this._lastMouseY=t.position.y;else t.wasReleased(0)&&(this._mouseDown=!1);0!==t.wheel&&(e.set(0,0,-1).applyQuaternion(this.camera.quaternion).multiplyScalar(t.wheel),this.camera.position.add(e))},zen3d.FreeController=t}();