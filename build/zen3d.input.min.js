!function(){function e(e){return"string"==typeof e?(e=e.toUpperCase(),n[e]||e.charCodeAt(0)):e}function t(t){var n,s,i;for(i=(s=(t=e(t)).toString(16).toUpperCase()).length,n=0;n<4-i;n++)s="0"+s;return"U+"+s}var n={TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,WIN:91},s=function(e,t){t=t||{},this._element=null,this._keyDownHandler=this._handleKeyDown.bind(this),this._keyUpHandler=this._handleKeyUp.bind(this),this._keyPressHandler=this._handleKeyPress.bind(this),this._keymap={},this._lastmap={},e&&this.attach(e),this.preventDefault=t.preventDefault||!1,this.stopPropagation=t.stopPropagation||!1};s.prototype.attach=function(e){this._element&&this.detach(),this._element=e,this._element.addEventListener("keydown",this._keyDownHandler,!1),this._element.addEventListener("keypress",this._keyPressHandler,!1),this._element.addEventListener("keyup",this._keyUpHandler,!1)},s.prototype.detach=function(){this._element.removeEventListener("keydown",this._keyDownHandler),this._element.removeEventListener("keypress",this._keyPressHandler),this._element.removeEventListener("keyup",this._keyUpHandler),this._element=null},s.prototype._handleKeyDown=function(e){var n=t(e.keyCode||e.charCode);this._keymap[n]=!0,this.preventDefault&&e.preventDefault(),this.stopPropagation&&e.stopPropagation()},s.prototype._handleKeyUp=function(e){var n=t(e.keyCode||e.charCode);delete this._keymap[n],this.preventDefault&&e.preventDefault(),this.stopPropagation&&e.stopPropagation()},s.prototype._handleKeyPress=function(e){t(e.keyCode||e.charCode);this.preventDefault&&e.preventDefault(),this.stopPropagation&&e.stopPropagation()},s.prototype.update=function(){var e;for(e in this._lastmap)delete this._lastmap[e];for(e in this._keymap)this._keymap.hasOwnProperty(e)&&(this._lastmap[e]=this._keymap[e])},s.prototype.isPressed=function(e){var n=t(e);return!!this._keymap[n]},s.prototype.wasPressed=function(e){var n=t(e);return!!this._keymap[n]&&!this._lastmap[n]},s.prototype.wasReleased=function(e){var n=t(keyCode);return!this._keymap[n]&&!!this._lastmap[n]},zen3d.Keyboard=s}(),function(){var e=function(e){this.position={x:0,y:0},this.wheel=0,this._upHandler=this._handleUp.bind(this),this._downHandler=this._handleDown.bind(this),this._moveHandler=this._handleMove.bind(this),this._wheelHandler=this._handleWheel.bind(this),this._contextMenuHandler=function(e){e.preventDefault()},this._buttons=[!1,!1,!1],this._lastbuttons=[!1,!1,!1],e&&this.attach(e)};e.prototype.disableContextMenu=function(){this._element&&this._element.addEventListener("contextmenu",this._contextMenuHandler)},e.prototype.enableContextMenu=function(){this._element&&this._element.removeEventListener("contextmenu",this._contextMenuHandler)},e.prototype.attach=function(e){this._element&&this.detach(),this._element=e,this._element.addEventListener("mouseup",this._upHandler,!1),this._element.addEventListener("mousedown",this._downHandler,!1),this._element.addEventListener("mousemove",this._moveHandler,!1),this._element.addEventListener("mousewheel",this._wheelHandler,!1),this._element.addEventListener("DOMMouseScroll",this._wheelHandler,!1)},e.prototype.detach=function(){this._element&&(this._element.removeEventListener("mouseup",this._upHandler,!1),this._element.removeEventListener("mousedown",this._downHandler,!1),this._element.removeEventListener("mousemove",this._moveHandler,!1),this._element.removeEventListener("mousewheel",this._wheelHandler,!1),this._element.removeEventListener("DOMMouseScroll",this._wheelHandler,!1),this._element=null)},e.prototype.update=function(){this._lastbuttons[0]=this._buttons[0],this._lastbuttons[1]=this._buttons[1],this._lastbuttons[2]=this._buttons[2],this.wheel=0},e.prototype.isPressed=function(e){return this._buttons[e]},e.prototype.wasPressed=function(e){return this._buttons[e]&&!this._lastbuttons[e]},e.prototype.wasReleased=function(e){return!this._buttons[e]&&this._lastbuttons[e]},e.prototype._handleUp=function(e){this._buttons[e.button]=!1},e.prototype._handleDown=function(e){this._buttons[e.button]=!0},e.prototype._handleMove=function(e){this.position.x=e.clientX,this.position.y=e.clientY},e.prototype._handleWheel=function(e){e.detail?this.wheel=-1*e.detail:e.wheelDelta?this.wheel=e.wheelDelta/120:this.wheel=0},zen3d.Mouse=e}();