!function(t){var e=t.zen3d=t.zen3d||{},i=function(){},r=function(t,e){i.prototype=e.prototype,t.superClass=e.prototype,t.prototype=new i,t.prototype.constructor=t};e.inherit=r;var n=function(){if(!t.navigator)return!0;var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("mobile")||-1!=e.indexOf("android")};e.isMobile=n;var a=function(t,e){var i=["","WEBKIT_","MOZ_"],r=null;for(var n in i)if(r=t.getExtension(i[n]+e))break;return r};e.getExtension=a;var o=function(t){var e=t>>16&255,i=t>>8&255,r=255&t;return[e,i,r]};e.hex2RGB=o;var s=function(t,e,i){var r=new Uint8Array(t*e*4),n=[[255,255,255,255],[0,0,0,255]];i=i||5;for(var a=0,o=0;e>o;o++)for(var s=0;t>s;s++){if(0==s?a=1:s%i==0&&(a=(a+1)%2),o%i==0&&0==s){var h=n[0];n[0]=n[1],n[1]=h}r[o*(4*t)+4*s+0]=n[a][0],r[o*(4*t)+4*s+1]=n[a][1],r[o*(4*t)+4*s+2]=n[a][2],r[o*(4*t)+4*s+3]=n[a][3]}return r};e.createCheckerBoardPixels=s}(window),function(){var t={MESH:"mesh",LIGHT:"light",CAMERA:"camera",SCENE:"scene",GROUP:"group"};zen3d.OBJECT_TYPE=t;var e={AMBIENT:"ambient",DIRECT:"direct",POINT:"point"};zen3d.LIGHT_TYPE=e;var i={BASIC:"basic",LAMBERT:"lambert",PHONE:"phone"};zen3d.MATERIAL_TYPE=i}(),function(){var t=function(e,i,r,n){this.x=e||0,this.y=i||0,this.z=r||0,this.order=n||t.DefaultOrder};t.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],t.DefaultOrder="XYZ",t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.order=t.order,this},t.prototype.set=function(t,e,i){return this.x=t||0,this.y=e||0,this.z=i||0,this.order=order||this.order,this},zen3d.Euler=t}(),function(){var t=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};t.prototype.identify=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.prototype.set=function(t,e,i,r,n,a,o,s,h,u,c,d,f,l,v,_){var p=this.elements;return p[0]=t,p[4]=e,p[8]=i,p[12]=r,p[1]=n,p[5]=a,p[9]=o,p[13]=s,p[2]=h,p[6]=u,p[10]=c,p[14]=d,p[3]=f,p[7]=l,p[11]=v,p[15]=_,this},t.prototype.copy=function(t){return this.elements.set(t.elements),this},t.prototype.multiply=function(t){return this.multiplyMatrices(this,t)},t.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},t.prototype.multiplyMatrices=function(t,e){var i=t.elements,r=e.elements,n=this.elements,a=i[0],o=i[4],s=i[8],h=i[12],u=i[1],c=i[5],d=i[9],f=i[13],l=i[2],v=i[6],_=i[10],p=i[14],E=i[3],m=i[7],T=i[11],y=i[15],g=r[0],b=r[4],M=r[8],x=r[12],A=r[1],L=r[5],z=r[9],R=r[13],P=r[2],U=r[6],S=r[10],N=r[14],I=r[3],F=r[7],C=r[11],O=r[15];return n[0]=a*g+o*A+s*P+h*I,n[4]=a*b+o*L+s*U+h*F,n[8]=a*M+o*z+s*S+h*C,n[12]=a*x+o*R+s*N+h*O,n[1]=u*g+c*A+d*P+f*I,n[5]=u*b+c*L+d*U+f*F,n[9]=u*M+c*z+d*S+f*C,n[13]=u*x+c*R+d*N+f*O,n[2]=l*g+v*A+_*P+p*I,n[6]=l*b+v*L+_*U+p*F,n[10]=l*M+v*z+_*S+p*C,n[14]=l*x+v*R+_*N+p*O,n[3]=E*g+m*A+T*P+y*I,n[7]=E*b+m*L+T*U+y*F,n[11]=E*M+m*z+T*S+y*C,n[15]=E*x+m*R+T*N+y*O,this},t.prototype.transpose=function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},t.prototype.inverse=function(){return this.getInverse(this)},t.prototype.getInverse=function(t){var e=this.elements,i=t.elements,r=i[0],n=i[1],a=i[2],o=i[3],s=i[4],h=i[5],u=i[6],c=i[7],d=i[8],f=i[9],l=i[10],v=i[11],_=i[12],p=i[13],E=i[14],m=i[15],T=f*E*c-p*l*c+p*u*v-h*E*v-f*u*m+h*l*m,y=_*l*c-d*E*c-_*u*v+s*E*v+d*u*m-s*l*m,g=d*p*c-_*f*c+_*h*v-s*p*v-d*h*m+s*f*m,b=_*f*u-d*p*u-_*h*l+s*p*l+d*h*E-s*f*E,M=r*T+n*y+a*g+o*b;if(0===M)return console.warn("can't invert matrix, determinant is 0"),this.identity();var x=1/M;return e[0]=T*x,e[1]=(p*l*o-f*E*o-p*a*v+n*E*v+f*a*m-n*l*m)*x,e[2]=(h*E*o-p*u*o+p*a*c-n*E*c-h*a*m+n*u*m)*x,e[3]=(f*u*o-h*l*o-f*a*c+n*l*c+h*a*v-n*u*v)*x,e[4]=y*x,e[5]=(d*E*o-_*l*o+_*a*v-r*E*v-d*a*m+r*l*m)*x,e[6]=(_*u*o-s*E*o-_*a*c+r*E*c+s*a*m-r*u*m)*x,e[7]=(s*l*o-d*u*o+d*a*c-r*l*c-s*a*v+r*u*v)*x,e[8]=g*x,e[9]=(_*f*o-d*p*o-_*n*v+r*p*v+d*n*m-r*f*m)*x,e[10]=(s*p*o-_*h*o+_*n*c-r*p*c-s*n*m+r*h*m)*x,e[11]=(d*h*o-s*f*o-d*n*c+r*f*c+s*n*v-r*h*v)*x,e[12]=b*x,e[13]=(d*p*a-_*f*a+_*n*l-r*p*l-d*n*E+r*f*E)*x,e[14]=(_*h*a-s*p*a-_*n*u+r*p*u+s*n*E-r*h*E)*x,e[15]=(s*f*a-d*h*a+d*n*u-r*f*u-s*n*l+r*h*l)*x,this},t.prototype.transform=function(t,e,i){var r=i.toMatrix4(),n=r.elements,a=this.elements;return a[0]=n[0]*e.x,a[1]=n[1]*e.y,a[2]=n[2]*e.z,a[3]=0,a[4]=n[4]*e.x,a[5]=n[5]*e.y,a[6]=n[6]*e.z,a[7]=0,a[8]=n[8]*e.x,a[9]=n[9]*e.y,a[10]=n[10]*e.z,a[11]=0,a[12]=t.x,a[13]=t.y,a[14]=t.z,a[15]=1,this},zen3d.Matrix4=t}(),function(){var t=function(t,e,i,r){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==r?r:1};t.prototype.set=function(t,e,i,r){return this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==r?r:1,this},t.prototype.setFromEuler=function(t){var e=Math.cos(t.x/2),i=Math.cos(t.y/2),r=Math.cos(t.z/2),n=Math.sin(t.x/2),a=Math.sin(t.y/2),o=Math.sin(t.z/2),s=t.order;return"XYZ"===s?(this.x=n*i*r+e*a*o,this.y=e*a*r-n*i*o,this.z=e*i*o+n*a*r,this.w=e*i*r-n*a*o):"YXZ"===s?(this.x=n*i*r+e*a*o,this.y=e*a*r-n*i*o,this.z=e*i*o-n*a*r,this.w=e*i*r+n*a*o):"ZXY"===s?(this.x=n*i*r-e*a*o,this.y=e*a*r+n*i*o,this.z=e*i*o+n*a*r,this.w=e*i*r-n*a*o):"ZYX"===s?(this.x=n*i*r-e*a*o,this.y=e*a*r+n*i*o,this.z=e*i*o-n*a*r,this.w=e*i*r+n*a*o):"YZX"===s?(this.x=n*i*r+e*a*o,this.y=e*a*r+n*i*o,this.z=e*i*o-n*a*r,this.w=e*i*r-n*a*o):"XZY"===s&&(this.x=n*i*r-e*a*o,this.y=e*a*r-n*i*o,this.z=e*i*o+n*a*r,this.w=e*i*r+n*a*o),this},t.prototype.toMatrix4=function(t){t||(t=new zen3d.Matrix4);var e=t.elements,i=2*this.x*this.y,r=2*this.x*this.z,n=2*this.x*this.w,a=2*this.y*this.z,o=2*this.y*this.w,s=2*this.z*this.w,h=this.x*this.x,u=this.y*this.y,c=this.z*this.z,d=this.w*this.w;return e[0]=h-u-c+d,e[4]=i-s,e[8]=r+o,e[12]=0,e[1]=i+s,e[5]=-h+u-c+d,e[9]=a-n,e[13]=0,e[2]=r-o,e[6]=a+n,e[10]=-h-u+c+d,e[14]=0,e[3]=0,e[7]=0,e[11]=0,e[15]=1,t},zen3d.Quaternion=t}(),function(){var t=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0};t.prototype.set=function(t,e,i){return this.x=t||0,this.y=e||0,this.z=i||0,this},t.prototype.getLength=function(){return Math.sqrt(this.getLengthSquared())},t.prototype.getLengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.prototype.normalize=function(t){t=t||1;var e=this.getLength();if(0!=e){var i=t/e;return this.x*=i,this.y*=i,void(this.z*=i)}},t.prototype.subtract=function(e,i){return i||(i=new t),i.set(this.x-e.x,this.y-e.y,this.z-e.z),i},t.prototype.crossProduct=function(e,i){return i||(i=new t),i.x=this.y*e.z-this.z*e.y,i.y=this.z*e.x-this.x*e.z,i.z=this.x*e.y-this.y*e.x,i},t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.applyQuaternion=function(t){var e=this.x,i=this.y,r=this.z,n=t.x,a=t.y,o=t.z,s=t.w,h=s*e+a*r-o*i,u=s*i+o*e-n*r,c=s*r+n*i-a*e,d=-n*e-a*i-o*r;return this.x=h*s+d*-n+u*-o-c*-a,this.y=u*s+d*-a+c*-n-h*-o,this.z=c*s+d*-o+h*-a-u*-n,this},zen3d.Vector3=t}(),function(){var t=function(t,e,i,r){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==r?r:1};t.prototype.set=function(t,e,i,r){return this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==r?r:1,this},t.prototype.applyMatrix4=function(t){var e=this.x,i=this.y,r=this.z,n=this.w,a=t.elements;return this.x=a[0]*e+a[4]*i+a[8]*r+a[12]*n,this.y=a[1]*e+a[5]*i+a[9]*r+a[13]*n,this.z=a[2]*e+a[6]*i+a[10]*r+a[14]*n,this.w=a[3]*e+a[7]*i+a[11]*r+a[15]*n,this},zen3d.Vector4=t}(),function(){var t=["attribute vec3 a_Position;","uniform mat4 u_Projection;","uniform mat4 u_View;","uniform mat4 u_Model;"].join("\n"),e=["#extension GL_OES_standard_derivatives : enable","precision mediump float;","uniform float u_Opacity;","uniform vec3 u_Color;"].join("\n"),i=["vec4 diffuseColor = vec4(u_Color, u_Opacity);","#ifdef USE_DIFFUSE_MAP","diffuseColor *= texture2D(texture, v_Uv);","#endif"].join("\n"),r=["#ifdef USE_NORMAL","vec3 N;","#ifdef USE_NORMAL_MAP","vec3 normalMapColor = texture2D(normalMap, v_Uv).rgb;","mat3 tspace = tsn(normalize(v_Normal), -v_VmPos, v_Uv);","N = normalize(tspace * (normalMapColor * 2.0 - 1.0));","#else","N = normalize(v_Normal);","#endif","#endif"].join("\n"),n=["struct AmbientLight","{","vec4 color;","float intensity;","};","uniform AmbientLight u_Ambient[USE_AMBIENT_LIGHT];"].join("\n"),a=["struct DirectLight","{","vec3 direction;","vec4 color;","float intensity;","};","uniform DirectLight u_Directional[USE_DIRECT_LIGHT];"].join("\n"),o=["struct PointLight","{","vec3 position;","vec4 color;","float intensity;","};","uniform PointLight u_Point[USE_POINT_LIGHT];"].join("\n"),s=["#ifdef USE_AMBIENT_LIGHT",n,"#endif","#ifdef USE_DIRECT_LIGHT",a,"#endif","#ifdef USE_POINT_LIGHT",o,"#endif"].join("\n"),h=["#ifdef USE_LIGHT","vec4 light;","vec3 L;","#ifdef USE_PHONE","vec3 V;","#endif","#ifdef USE_AMBIENT_LIGHT","for(int i = 0; i < USE_AMBIENT_LIGHT; i++) {","gl_FragColor += diffuseColor * u_Ambient[i].color * u_Ambient[i].intensity;","}","#endif","#ifdef USE_DIRECT_LIGHT","for(int i = 0; i < USE_DIRECT_LIGHT; i++) {","L = -u_Directional[i].direction;","light = u_Directional[i].color * u_Directional[i].intensity;","L = normalize(L);","RE_Lambert(diffuseColor, light, N, L, gl_FragColor);","#ifdef USE_PHONE","V = normalize(u_Eye - v_VmPos);","RE_BlinnPhone(diffuseColor, light, N, normalize(L), V, u_Specular, gl_FragColor);","#endif","}","#endif","#ifdef USE_POINT_LIGHT","for(int i = 0; i < USE_POINT_LIGHT; i++) {","L = u_Point[i].position - v_VmPos;","float dist = max(1. - length(L) * .005, 0.0);","light = u_Point[i].color * u_Point[i].intensity * dist;","L = normalize(L);","RE_Lambert(diffuseColor, light, N, L, gl_FragColor);","#ifdef USE_PHONE","V = normalize(u_Eye - v_VmPos);","RE_BlinnPhone(diffuseColor, light, N, normalize(L), V, u_Specular, gl_FragColor);","#endif","}","#endif","#endif"].join("\n"),u=["void RE_Lambert(vec4 k, vec4 light, vec3 N, vec3 L, inout vec4 reflectLight) {","float dotNL = max(dot(N, L), 0.);","reflectLight += k * light * dotNL;","}"].join("\n"),c=["void RE_Phone(vec4 k, vec4 light, vec3 N, vec3 L, vec3 V, float n_s, inout vec4 reflectLight) {","vec3 R = max(dot(2.0 * N, L), 0.) * N - L;","reflectLight += k * light * pow(max(dot(V, R), 0.), n_s);","}"].join("\n"),d=["void RE_BlinnPhone(vec4 k, vec4 light, vec3 N, vec3 L, vec3 V, float n_s, inout vec4 reflectLight) {","vec3 H = normalize(L + V);","reflectLight += k * light * pow(max(dot(N, H), 0.), n_s);","}"].join("\n"),f="mat4 transpose(mat4 inMatrix) { \nvec4 i0 = inMatrix[0]; \nvec4 i1 = inMatrix[1]; \nvec4 i2 = inMatrix[2]; \nvec4 i3 = inMatrix[3]; \nmat4 outMatrix = mat4( \nvec4(i0.x, i1.x, i2.x, i3.x), \nvec4(i0.y, i1.y, i2.y, i3.y), \nvec4(i0.z, i1.z, i2.z, i3.z), \nvec4(i0.w, i1.w, i2.w, i3.w) \n); \nreturn outMatrix; \n} \n",l="mat4 inverse(mat4 m) { \nfloat \na00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3], \na10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3], \na20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3], \na30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3], \nb00 = a00 * a11 - a01 * a10, \nb01 = a00 * a12 - a02 * a10, \nb02 = a00 * a13 - a03 * a10, \nb03 = a01 * a12 - a02 * a11, \nb04 = a01 * a13 - a03 * a11, \nb05 = a02 * a13 - a03 * a12, \nb06 = a20 * a31 - a21 * a30, \nb07 = a20 * a32 - a22 * a30, \nb08 = a20 * a33 - a23 * a30, \nb09 = a21 * a32 - a22 * a31, \nb10 = a21 * a33 - a23 * a31, \nb11 = a22 * a33 - a23 * a32, \ndet = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06; \nreturn mat4( \na11 * b11 - a12 * b10 + a13 * b09, \na02 * b10 - a01 * b11 - a03 * b09, \na31 * b05 - a32 * b04 + a33 * b03, \na22 * b04 - a21 * b05 - a23 * b03, \na12 * b08 - a10 * b11 - a13 * b07, \na00 * b11 - a02 * b08 + a03 * b07, \na32 * b02 - a30 * b05 - a33 * b01, \na20 * b05 - a22 * b02 + a23 * b01, \na10 * b10 - a11 * b08 + a13 * b06, \na01 * b08 - a00 * b10 - a03 * b06, \na30 * b04 - a31 * b02 + a33 * b00, \na21 * b02 - a20 * b04 - a23 * b00, \na11 * b07 - a10 * b09 - a12 * b06, \na00 * b09 - a01 * b07 + a02 * b06, \na31 * b01 - a30 * b03 - a32 * b00, \na20 * b03 - a21 * b01 + a22 * b00) / det; \n} \n",v=["mat3 tsn(vec3 N, vec3 p, vec2 uv) {","vec3 q0 = dFdx( p.xyz );","vec3 q1 = dFdy( p.xyz );","vec2 st0 = dFdx( uv.st );","vec2 st1 = dFdy( uv.st );","vec3 S = normalize( q0 * st1.t - q1 * st0.t );","vec3 T = normalize( -q0 * st1.s + q1 * st0.s );","mat3 tsn = mat3( S, T, N );","return tsn;","}"].join("\n"),_="mat3 tbn(vec3 N, vec3 p, vec2 uv) { \nvec3 dp1 = dFdx(p.xyz); \nvec3 dp2 = dFdy(p.xyz); \nvec2 duv1 = dFdx(uv.st); \nvec2 duv2 = dFdy(uv.st); \nvec3 dp2perp = cross(dp2, N); \nvec3 dp1perp = cross(N, dp1); \nvec3 T = dp2perp * duv1.x + dp1perp * duv2.x; \nvec3 B = dp2perp * duv1.y + dp1perp * duv2.y; \nfloat invmax = 1.0 / sqrt(max(dot(T,T), dot(B,B))); \nreturn mat3(T * invmax, B * invmax, N); \n} \n",p={basicVertex:[t,"#ifdef USE_DIFFUSE_MAP","attribute vec2 a_Uv;","varying vec2 v_Uv;","#endif","void main() {","gl_Position = u_Projection * u_View * u_Model * vec4(a_Position, 1.0);","#ifdef USE_DIFFUSE_MAP","v_Uv = a_Uv;","#endif","}"].join("\n"),basicFragment:[e,"#ifdef USE_DIFFUSE_MAP","varying vec2 v_Uv;","uniform sampler2D texture;","#endif","void main() {","gl_FragColor = vec4(0., 0., 0., 0.);",i,"gl_FragColor = diffuseColor;","}"].join("\n"),lambertVertex:[t,"#ifdef USE_NORMAL",f,l,"#endif","#ifdef USE_NORMAL","attribute vec3 a_Normal;","varying vec3 v_Normal;","#endif","#if defined(USE_DIFFUSE_MAP) || defined(USE_NORMAL_MAP)","attribute vec2 a_Uv;","varying vec2 v_Uv;","#endif","#if defined(USE_POINT_LIGHT) || defined(USE_NORMAL_MAP)","varying vec3 v_VmPos;","#endif","void main() {","gl_Position = u_Projection * u_View * u_Model * vec4(a_Position, 1.0);","#ifdef USE_NORMAL","v_Normal = (transpose(inverse(u_View * u_Model)) * vec4(a_Normal, 1.0)).xyz;","#endif","#if defined(USE_DIFFUSE_MAP) || defined(USE_NORMAL_MAP)","v_Uv = a_Uv;","#endif","#if defined(USE_POINT_LIGHT) || defined(USE_NORMAL_MAP)","v_VmPos = (u_View * u_Model * vec4(a_Position, 1.0)).xyz;","#endif","}"].join("\n"),lambertFragment:[e,"#ifdef USE_NORMAL_MAP",v,_,"#endif","#if defined(USE_DIFFUSE_MAP) || defined(USE_NORMAL_MAP)","varying vec2 v_Uv;","#endif","#ifdef USE_DIFFUSE_MAP","uniform sampler2D texture;","#endif","#ifdef USE_NORMAL_MAP","uniform sampler2D normalMap;","#endif",s,"#ifdef USE_NORMAL","varying vec3 v_Normal;","#endif","#if defined(USE_POINT_LIGHT) || defined(USE_NORMAL_MAP)","varying vec3 v_VmPos;","#endif",u,"void main() {","gl_FragColor = vec4(0., 0., 0., 0.);",i,r,h,"}"].join("\n"),phoneVertex:[t,"#ifdef USE_NORMAL",f,l,"#endif","#ifdef USE_NORMAL","attribute vec3 a_Normal;","varying vec3 v_Normal;","#endif","#if defined(USE_DIFFUSE_MAP) || defined(USE_NORMAL_MAP)","attribute vec2 a_Uv;","varying vec2 v_Uv;","#endif","varying vec3 v_VmPos;","void main() {","gl_Position = u_Projection * u_View * u_Model * vec4(a_Position, 1.0);","#ifdef USE_NORMAL","v_Normal = (transpose(inverse(u_View * u_Model)) * vec4(a_Normal, 1.0)).xyz;","#endif","#if defined(USE_DIFFUSE_MAP) || defined(USE_NORMAL_MAP)","v_Uv = a_Uv;","#endif","v_VmPos = (u_View * u_Model * vec4(a_Position, 1.0)).xyz;","}"].join("\n"),phoneFragment:[e,"#ifdef USE_NORMAL_MAP",v,_,"#endif","#if defined(USE_DIFFUSE_MAP) || defined(USE_NORMAL_MAP)","varying vec2 v_Uv;","#endif","#ifdef USE_DIFFUSE_MAP","uniform sampler2D texture;","#endif","#ifdef USE_NORMAL_MAP","uniform sampler2D normalMap;","#endif",s,"#ifdef USE_NORMAL","varying vec3 v_Normal;","#endif","varying vec3 v_VmPos;","uniform vec3 u_Eye;","uniform float u_Specular;",u,c,d,"void main() {","gl_FragColor = vec4(0., 0., 0., 0.);",i,r,h,"}"].join("\n")};zen3d.ShaderLib=p}(),function(){function t(t,e,i){var r=t.createShader(e);t.shaderSource(r,i),t.compileShader(r);var n=t.getShaderParameter(r,t.COMPILE_STATUS);return n||(console.log("shader not compiled!"),console.log(t.getShaderInfoLog(r))),r}function e(t,e,i){var r=t.createProgram();return t.attachShader(r,e),t.attachShader(r,i),t.linkProgram(r),r}function i(t,e){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=0;r>n;n++){var a=t.getActiveUniform(e,n),o=a.name,s=a.type;i[o]={type:s,size:a.size,location:t.getUniformLocation(e,o)}}return i}function r(t,e){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),n=0;r>n;n++){var a=t.getActiveAttrib(e,n),o=a.name,s=a.type;i[o]={type:s,size:1,location:t.getAttribLocation(e,o)}}return i}function n(t){var e="";for(var i in t)e+=t[i]+"_";return e}function a(t,e){var i=e.materialType==h.BASIC,r=zen3d.ShaderLib.vertexBase,n=zen3d.ShaderLib.fragmentBase;switch(e.materialType){case h.BASIC:r=zen3d.ShaderLib.basicVertex,n=zen3d.ShaderLib.basicFragment;break;case h.LAMBERT:r=zen3d.ShaderLib.lambertVertex,n=zen3d.ShaderLib.lambertFragment;break;case h.PHONE:r=zen3d.ShaderLib.phoneVertex,n=zen3d.ShaderLib.phoneFragment}var a=[!i&&e.pointLightNum>0?"#define USE_POINT_LIGHT "+e.pointLightNum:"",!i&&(e.pointLightNum>0||e.directLightNum>0||e.ambientLightNum>0)?"#define USE_LIGHT":"",e.pointLightNum>0||e.directLightNum>0?"#define USE_NORMAL":"",(e.pointLightNum>0||e.directLightNum>0)&&e.useNormalMap?"#define USE_NORMAL_MAP":"",e.useDiffuseMap?"#define USE_DIFFUSE_MAP":"",e.materialType==h.BASIC?"#define USE_BASIC":"",e.materialType==h.LAMBERT?"#define USE_LAMBERT":"",e.materialType==h.PHONE?"#define USE_PHONE":"",r].join("\n"),o=[(!i&&e.pointLightNum)>0?"#define USE_POINT_LIGHT "+e.pointLightNum:"",(!i&&e.directLightNum)>0?"#define USE_DIRECT_LIGHT "+e.directLightNum:"",(!i&&e.ambientLightNum)>0?"#define USE_AMBIENT_LIGHT "+e.ambientLightNum:"",!i&&(e.pointLightNum>0||e.directLightNum>0||e.ambientLightNum>0)?"#define USE_LIGHT":"",e.pointLightNum>0||e.directLightNum>0?"#define USE_NORMAL":"",(e.pointLightNum>0||e.directLightNum>0)&&e.useNormalMap?"#define USE_NORMAL_MAP":"",e.useDiffuseMap?"#define USE_DIFFUSE_MAP":"",e.materialType==h.BASIC?"#define USE_BASIC":"",e.materialType==h.LAMBERT?"#define USE_LAMBERT":"",e.materialType==h.PHONE?"#define USE_PHONE":"",n].join("\n");return new s(t,a,o)}var o={},s=function(n,a,o){this.vshaderSource=a,this.fshaderSource=o,this.vertexShader=t(n,n.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=t(n,n.FRAGMENT_SHADER,this.fshaderSource),this.id=e(n,this.vertexShader,this.fragmentShader),this.uniforms=i(n,this.id),this.attributes=r(n,this.id)},h=zen3d.MATERIAL_TYPE,u=function(t,e,i){var r,s=i[0],h=i[1],u=i[2],c={useDiffuseMap:!!e.map,useNormalMap:!!e.normalMap,useDiffuseColor:!e.map,ambientLightNum:s,directLightNum:h,pointLightNum:u,materialType:e.type},d=n(c),f=o;return f[d]?r=f[d]:(r=a(t,c),f[d]=r),r};zen3d.getProgram=u}(),function(){var t=zen3d.MATERIAL_TYPE,e=function(t){this.view=t;var e=this.gl=t.getContext("webgl",{antialias:!0,stencil:!0});this.width=t.clientWidth,this.height=t.clientHeight,this.vertices=new Float32Array(4e4),this.vertexBuffer=e.createBuffer(),this.indices=new Uint16Array(12e3),this.indexBuffer=e.createBuffer(),e.enable(e.STENCIL_TEST),e.enable(e.DEPTH_TEST),this.cache=new zen3d.RenderCache,this.camera=null;zen3d.getExtension(e,"OES_standard_derivatives"),zen3d.getExtension(e,"GL_OES_standard_derivatives")};e.prototype.render=function(t,e){this.camera=e,t.updateMatrix(),this.cache.cache(t),this.cache.sort(),this.flush(),this.cache.clear()},e.prototype.flush=function(){this.flushList(this.cache.opaqueObjects),this.flushList(this.cache.transparentObjects)},e.prototype.flushList=function(e){for(var i=this.camera,r=this.vertices,n=this.indices,a=this.cache.ambientLights,o=this.cache.directLights,s=this.cache.pointLights,h=a.length,u=o.length,c=s.length,d=0,f=e.length;f>d;d++){for(var l=e[d],v=l.geometry,_=l.material,p=(this.lights,0),E=0,m=0,T=v.verticesArray,y=T.length;y>m;m++)r[p++]=T[m];for(var g=0,b=v.indicesArray,M=b.length;M>g;g++)n[E++]=b[g];var x=this.gl;x.bindBuffer(x.ARRAY_BUFFER,this.vertexBuffer),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var A=r.subarray(0,p);x.bufferData(x.ARRAY_BUFFER,A,x.STREAM_DRAW);var L=n.subarray(0,E);x.bufferData(x.ELEMENT_ARRAY_BUFFER,L,x.STATIC_DRAW);var z=zen3d.getProgram(x,_,[h,u,c]),R=z.uniforms,P=z.attributes;x.useProgram(z.id);var U=P.a_Position.location;x.vertexAttribPointer(U,3,x.FLOAT,!1,68,0),x.enableVertexAttribArray(U);var S=i.projectionMatrix.elements;x.uniformMatrix4fv(R.u_Projection.location,!1,S);var N=i.viewMatrix.elements;x.uniformMatrix4fv(R.u_View.location,!1,N);var I=l.worldMatrix.elements;x.uniformMatrix4fv(R.u_Model.location,!1,I),x.uniform1f(R.u_Opacity.location,_.opacity);var F=zen3d.hex2RGB(_.color);x.uniform3f(R.u_Color.location,F[0]/255,F[1]/255,F[2]/255);var C=_.type==t.BASIC,O=new zen3d.Matrix4,w=new zen3d.Vector4;if(!C){for(var g=0;h>g;g++){var B=a[g],D=B.intensity,F=zen3d.hex2RGB(B.color),G=R["u_Ambient["+g+"].intensity"].location,H=R["u_Ambient["+g+"].color"].location;x.uniform4f(H,F[0]/255,F[1]/255,F[2]/255,1),x.uniform1f(G,D)}for(var g=0;u>g;g++){var B=o[g],D=B.intensity,V=B.direction,j=O.copy(i.viewMatrix).inverse().transpose();w.set(V.x,V.y,V.z,1).applyMatrix4(j);var F=zen3d.hex2RGB(B.color),X=R["u_Directional["+g+"].direction"].location,Y=R["u_Directional["+g+"].intensity"].location,q=R["u_Directional["+g+"].color"].location;x.uniform3f(X,w.x,w.y,w.z),x.uniform1f(Y,D),x.uniform4f(q,F[0]/255,F[1]/255,F[2]/255,1)}for(var g=0;c>g;g++){var B=s[g],k=B.position,N=i.viewMatrix;w.set(k.x,k.y,k.z,1).applyMatrix4(N);var D=B.intensity,F=zen3d.hex2RGB(B.color),Z=R["u_Point["+g+"].position"].location;x.uniform3f(Z,w.x,w.y,w.z);var W=R["u_Point["+g+"].intensity"].location;x.uniform1f(W,D);var J=R["u_Point["+g+"].color"].location;x.uniform4f(J,F[0]/255,F[1]/255,F[2]/255,1)}if(u>0||c>0){var K=P.a_Normal.location;x.vertexAttribPointer(K,3,x.FLOAT,!1,68,12),x.enableVertexAttribArray(K),_.normalMap&&(x.activeTexture(x.TEXTURE1),x.bindTexture(x.TEXTURE_2D,_.normalMap.glTexture),x.uniform1i(R.normalMap.location,1))}if(_.type==t.PHONE){var Q=i.position,N=i.viewMatrix;w.set(Q.x,Q.y,Q.z,1).applyMatrix4(N),x.uniform3f(R.u_Eye.location,w.x,w.y,w.z);var $=_.specular;x.uniform1f(R.u_Specular.location,$)}}if((u>0||c>0)&&_.normalMap||_.map){var tt=P.a_Uv.location;x.vertexAttribPointer(tt,2,x.FLOAT,!1,68,52),x.enableVertexAttribArray(tt)}_.map&&(x.activeTexture(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,_.map.glTexture),x.uniform1i(R.texture.location,0)),_.transparent?(x.enable(x.BLEND),x.blendFunc(x.ONE,x.ONE_MINUS_SRC_ALPHA)):x.disable(x.BLEND),x.drawElements(x.TRIANGLES,E,x.UNSIGNED_SHORT,0)}},zen3d.Renderer=e}(),function(){var t=zen3d.OBJECT_TYPE,e=zen3d.LIGHT_TYPE,i=function(){this.opaqueObjects=new Array,this.transparentObjects=new Array,this.ambientLights=new Array,this.directLights=new Array,this.pointLights=new Array};i.prototype.cache=function(i){switch(i.type){case t.MESH:var r=i.material;r.checkMapInit()&&(r.transparent?this.transparentObjects.push(i):this.opaqueObjects.push(i));break;case t.LIGHT:i.lightType==e.AMBIENT?this.ambientLights.push(i):i.lightType==e.DIRECT?this.directLights.push(i):i.lightType==e.POINT&&this.pointLights.push(i);break;case t.CAMERA:break;case t.SCENE:break;case t.GROUP:break;default:console.log("undefined object type")}for(var n=i.children,a=0,o=n.length;o>a;a++)this.cache(n[a])},i.prototype.sort=function(){this.opaqueObjects.sort(function(t,e){var i=t.position.z,r=e.position.z;return i-r}),this.transparentObjects.sort(function(t,e){var i=t.position.z,r=e.position.z;return r-i})},i.prototype.clear=function(){this.transparentObjects.length=0,this.opaqueObjects.length=0,this.ambientLights.length=0,this.directLights.length=0,this.pointLights.length=0},zen3d.RenderCache=i}(),function(){var t=function(t,e,i){this.gl=t,this.width=e,this.height=i,this.frameBuffer=t.createFramebuffer(),this.renderBuffer=null};t.prototype.bind=function(){var t=this.gl;return t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),this},t.prototype.unbind=function(){var t=this.gl;return t.bindFramebuffer(t.FRAMEBUFFER,null),this},t.prototype.attachRenderBuffer=function(t){var e=this.gl,i=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,i),"depth"==t?(e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this.width,this.height)):"stencil"==t?(e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,this.width,this.height)):(e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.width,this.height)),this.renderBuffer=i,this},t.prototype.bindTexture2D=function(t){var e=this.gl;return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.glTexture,0),this},t.prototype.bindTextureCube=function(t,e){var i=this.gl;return i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,t.faces[e],t.glTexture,0),this},t.prototype.resize=function(t,e){},t.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),this.renderBuffer&&t.deleteRenderbuffer(this.renderBuffer)},zen3d.RenderTarget=t}(),function(){var t=function(t,e){this.name="",this.type="",this.position=new zen3d.Vector3,this.scale=new zen3d.Vector3(1,1,1),this.euler=new zen3d.Euler,this.quaternion=new zen3d.Quaternion,this.matrix=new zen3d.Matrix4,this.worldMatrix=new zen3d.Matrix4,this.children=new Array,this.parent=null};Object.defineProperties(t.prototype,{rotation:{get:function(){return this.euler},set:function(t){var e=this.euler;e.copyFrom(t),this.quaternion.setFromEuler(t)}}}),t.prototype.add=function(t){this.children.push(t),t.parent=this},t.prototype.remove=function(t){var e=this.children.indexOf(t);-1!==e&&this.children.splice(e,1),t.parent=null},t.prototype.updateMatrix=function(){var t=this.matrix.transform(this.position,this.scale,this.quaternion);if(this.worldMatrix.copy(t),this.parent){var e=this.parent.worldMatrix;this.worldMatrix.premultiply(e)}for(var i=this.children,r=0,n=i.length;n>r;r++)i[r].updateMatrix()},zen3d.Object3D=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.type=zen3d.OBJECT_TYPE.SCENE};zen3d.inherit(t,zen3d.Object3D),zen3d.Scene=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.type=zen3d.OBJECT_TYPE.GROUP};zen3d.inherit(t,zen3d.Object3D),zen3d.Group=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.type=zen3d.OBJECT_TYPE.LIGHT,this.lightType="",this.color=16777215,this.intensity=1};zen3d.inherit(t,zen3d.Object3D),zen3d.Light=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.lightType=zen3d.LIGHT_TYPE.AMBIENT};zen3d.inherit(t,zen3d.Light),zen3d.AmbientLight=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.lightType=zen3d.LIGHT_TYPE.DIRECT,this.direction=new zen3d.Vector3};zen3d.inherit(t,zen3d.Light),zen3d.DirectionalLight=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.lightType=zen3d.LIGHT_TYPE.POINT,this.decay=2};zen3d.inherit(t,zen3d.Light),zen3d.PointLight=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.type=zen3d.OBJECT_TYPE.CAMERA,this.viewMatrix=new zen3d.Matrix4,this.projectionMatrix=new zen3d.Matrix4};zen3d.inherit(t,zen3d.Object3D),t.prototype.setLookAt=function(t,e){var i=this.position,r=new zen3d.Vector3;i.subtract(t,r),r.normalize();var n=new zen3d.Vector3;e.crossProduct(r,n),n.normalize();var a=new zen3d.Vector3;r.crossProduct(n,a),this.viewMatrix.set(-n.x,-n.y,-n.z,-n.dotProduct(i),a.x,a.y,a.z,-a.dotProduct(i),r.x,r.y,r.z,-r.dotProduct(i),0,0,0,1)},t.prototype.setOrtho=function(t,e,i,r,n,a){this.projectionMatrix.set(2/(e-t),0,0,-(e+t)/(e-t),0,2/(r-i),0,-(r+i)/(r-i),0,0,-2/(a-n),-(a+n)/(a-n),0,0,0,1)},t.prototype.setPerspective=function(t,e,i,r){this.projectionMatrix.set(1/(e*Math.tan(t/2)),0,0,0,0,1/Math.tan(t/2),0,0,0,0,-(r+i)/(r-i),-2*r*i/(r-i),0,0,-1,0)},zen3d.Camera=t}(),function(){var t=function(){this.verticesArray=new Array,this.indicesArray=new Array,this.verticesCount=0};zen3d.Geometry=t}(),function(){var t=function(e,i,r){t.superClass.constructor.call(this),this.buildGeometry(e,i,r)};zen3d.inherit(t,zen3d.Geometry),t.prototype.buildGeometry=function(t,e,i){this.verticesArray.push(.5*-t,.5*-e,.5*-i,0,0,-10,1,0,0,1,1,1,1,1,0,0,0,.5*-t,.5*e,.5*-i,0,0,-10,1,0,0,1,1,1,1,1,1,0,0,.5*t,.5*e,.5*-i,0,0,-10,1,0,0,1,1,1,1,0,1,0,0,.5*t,.5*e,.5*-i,0,0,-10,1,0,0,1,1,1,1,0,1,0,0,.5*t,.5*-e,.5*-i,0,0,-10,1,0,0,1,1,1,1,0,0,0,0,.5*-t,.5*-e,.5*-i,0,0,-10,1,0,0,1,1,1,1,1,0,0,0,.5*-t,.5*-e,.5*i,0,0,10,1,0,0,1,1,1,1,0,0,0,0,.5*t,.5*-e,.5*i,0,0,10,1,0,0,1,1,1,1,1,0,0,0,.5*t,.5*e,.5*i,0,0,10,1,0,0,1,1,1,1,1,1,0,0,.5*t,.5*e,.5*i,0,0,10,1,0,0,1,1,1,1,1,1,0,0,.5*-t,.5*e,.5*i,0,0,10,1,0,0,1,1,1,1,0,1,0,0,.5*-t,.5*-e,.5*i,0,0,10,1,0,0,1,1,1,1,0,0,0,0,.5*-t,.5*-e,.5*-i,0,-10,0,1,0,0,1,1,1,1,0,0,0,0,.5*t,.5*-e,.5*-i,0,-10,0,1,0,0,1,1,1,1,1,0,0,0,.5*t,.5*-e,.5*i,0,-10,0,1,0,0,1,1,1,1,1,1,0,0,.5*t,.5*-e,.5*i,0,-10,0,1,0,0,1,1,1,1,1,1,0,0,.5*-t,.5*-e,.5*i,0,-10,0,1,0,0,1,1,1,1,0,1,0,0,.5*-t,.5*-e,.5*-i,0,-10,0,1,0,0,1,1,1,1,0,0,0,0,.5*t,.5*-e,.5*-i,10,0,0,1,0,0,1,1,1,1,0,0,0,0,.5*t,.5*e,.5*-i,10,0,0,1,0,0,1,1,1,1,1,0,0,0,.5*t,.5*e,.5*i,10,0,0,1,0,0,1,1,1,1,1,1,0,0,.5*t,.5*e,.5*i,10,0,0,1,0,0,1,1,1,1,1,1,0,0,.5*t,.5*-e,.5*i,10,0,0,1,0,0,1,1,1,1,0,1,0,0,.5*t,.5*-e,.5*-i,10,0,0,1,0,0,1,1,1,1,0,0,0,0,.5*t,.5*e,.5*-i,0,10,0,1,0,0,1,1,1,1,0,0,0,0,.5*-t,.5*e,.5*-i,0,10,0,1,0,0,1,1,1,1,1,0,0,0,.5*-t,.5*e,.5*i,0,10,0,1,0,0,1,1,1,1,1,1,0,0,.5*-t,.5*e,.5*i,0,10,0,1,0,0,1,1,1,1,1,1,0,0,.5*t,.5*e,.5*i,0,10,0,1,0,0,1,1,1,1,0,1,0,0,.5*t,.5*e,.5*-i,0,10,0,1,0,0,1,1,1,1,0,0,0,0,.5*-t,.5*e,.5*-i,-10,0,0,1,0,0,1,1,1,1,0,0,0,0,.5*-t,.5*-e,.5*-i,-10,0,0,1,0,0,1,1,1,1,1,0,0,0,.5*-t,.5*-e,.5*i,-10,0,0,1,0,0,1,1,1,1,1,1,0,0,.5*-t,.5*-e,.5*i,-10,0,0,1,0,0,1,1,1,1,1,1,0,0,.5*-t,.5*e,.5*i,-10,0,0,1,0,0,1,1,1,1,0,1,0,0,.5*-t,.5*e,.5*-i,-10,0,0,1,0,0,1,1,1,1,0,0,0,0),this.indicesArray.push(0,2,1,3,5,4,6,8,7,9,11,10,12,14,13,15,17,16,18,20,19,21,23,22,24,26,25,27,29,28,30,32,31,33,35,34),this.verticesCount=36},zen3d.CubeGeometry=t}(),function(){var t=function(e,i,r,n){t.superClass.constructor.call(this),this.buildGeometry(e,i,r||1,n||1)};zen3d.inherit(t,zen3d.Geometry),t.prototype.buildGeometry=function(t,e,i,r){for(var n=i+1,a=r+1,o=this.verticesArray,s=this.indicesArray,h=0,u=0,c=0;a>c;c++)for(var d=0;n>d;d++){var f=(d/i-.5)*t,l=(c/r-.5)*e;if(o[h++]=f,o[h++]=0,o[h++]=l,o[h++]=0,o[h++]=1,o[h++]=0,o[h++]=1,o[h++]=0,o[h++]=0,o[h++]=1,o[h++]=1,o[h++]=1,o[h++]=1,o[h++]=d/i*1,o[h++]=1*(1-c/r),o[h++]=d/i*1,o[h++]=1*(1-c/r),d!=i&&c!=r){base=d+c*n;var v=1;s[u++]=base*v,s[u++]=(base+n+1)*v,s[u++]=(base+n)*v,s[u++]=base*v,s[u++]=(base+1)*v,s[u++]=(base+n+1)*v}}this.verticesCount=n*a},zen3d.PlaneGeometry=t}(),function(){var t=function(e,i,r){t.superClass.constructor.call(this),this.buildGeometry(e,i||20,r||20)};zen3d.inherit(t,zen3d.Geometry),t.prototype.buildGeometry=function(t,e,i){var r=!0,n=0,a=0,o=0,s=17,h=s-9,u=this.verticesArray,c=this.indicesArray,d=0,f=0,l=0,v=0,_=0,p=0;for(a=0;i>=a;++a){d=f;var E=Math.PI*a/i,m=-t*Math.cos(E),T=t*Math.sin(E);for(n=0;e>=n;++n){var y=2*Math.PI*n/e,g=T*Math.cos(y),b=T*Math.sin(y),M=1/Math.sqrt(g*g+b*b+m*m),x=Math.sqrt(b*b+g*g);if(_=0,p=x>.007?g/x:0,l=-m,v=b,n==e?(u[f++]=u[d],u[f++]=u[d+1],u[f++]=u[d+2],u[f++]=g*M,u[f++]=l*M,u[f++]=v*M,u[f++]=x>.007?-b/x:1,u[f++]=_,u[f++]=p,u[f+0]=1,u[f+1]=1,u[f+2]=1,u[f+3]=1):(u[f++]=g,u[f++]=l,u[f++]=v,u[f++]=g*M,u[f++]=l*M,u[f++]=v*M,u[f++]=x>.007?-b/x:1,u[f++]=_,u[f++]=p,u[f]=1,u[f+1]=1,u[f+2]=1,u[f+3]=1),n>0&&a>0){var A=(e+1)*a+n,L=(e+1)*a+n-1,z=(e+1)*(a-1)+n-1,R=(e+1)*(a-1)+n;a==i?(u[f-9]=u[d],u[f-8]=u[d+1],u[f-7]=u[d+2],r?(c[o++]=A,c[o++]=R,c[o++]=z):(c[o++]=A,c[o++]=z,c[o++]=R)):1==a?r?(c[o++]=A,c[o++]=z,c[o++]=L):(c[o++]=A,c[o++]=L,c[o++]=z):r?(c[o++]=A,c[o++]=R,c[o++]=z,c[o++]=A,c[o++]=z,c[o++]=L):(c[o++]=A,c[o++]=z,c[o++]=R,c[o++]=A,c[o++]=L,c[o++]=z)}f+=h}}var s=17,h=s-2,f=13;for(a=0;i>=a;++a)for(n=0;e>=n;++n)u[f++]=n/e,u[f++]=a/i,f+=h;this.verticesCount=(i+1)*(e+1)},zen3d.SphereGeometry=t}(),function(){var t=function(t,e){this.gl=t,this.width=0,this.height=0,this.border=0,this.dataFormat=t.RGBA,this.dataType=t.UNSIGNED_BYTE,this.magFilter=t.LINEAR,
this.minFilter=t.LINEAR,this.wrapS=t.CLAMP_TO_EDGE,this.wrapT=t.CLAMP_TO_EDGE,this.glTexture=t.createTexture(),this.isRenderable=!1,t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0)};t.prototype.bind=function(){},t.prototype.texParam=function(){},t.prototype.texImage=function(){},t.prototype.destory=function(){var t=this.gl;t.deleteTexture(this.glTexture)},zen3d.TextureBase=t}(),function(){var t=function(e,i){t.superClass.constructor.call(this,e,i)};zen3d.inherit(t,zen3d.TextureBase),t.prototype.bind=function(){var t=this.gl;return t.bindTexture(t.TEXTURE_2D,this.glTexture),this},t.prototype.texParam=function(){var t=this.gl;return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.minFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapT),this},t.prototype.texImage=function(t,e,i){var r=this.gl;return void 0!==e&&void 0!==i?(r.texImage2D(r.TEXTURE_2D,0,this.dataFormat,e,i,this.border,this.dataFormat,this.dataType,t),this.width=e,this.height=i):(r.texImage2D(r.TEXTURE_2D,0,this.dataFormat,this.dataFormat,this.dataType,t),this.width=t.width,this.height=t.height),this.isRenderable=!0,this},t.fromRes=function(e,i,r,n){var a=new t(e);return a.bind().texParam().texImage(i,r,n),a},t.fromSrc=function(e,i){var r=new t(e),n=new Image;return n.src=i,n.onload=function(){r.bind().texParam().texImage(n)},r},t.createRenderTexture=function(e,i,r){var n=new t(e);return n.bind().texParam().texImage(null,i,r),n},zen3d.Texture2D=t}(),function(){var t=function(e,i){t.superClass.constructor.call(this,e,i);var e=this.gl;this.faces=[e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Z]};zen3d.inherit(t,zen3d.TextureBase),t.prototype.bind=function(){var t=this.gl;return t.bindTexture(t.TEXTURE_CUBE_MAP,this.glTexture),this},t.prototype.texParam=function(){var t=this.gl;return t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,this.magFilter),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,this.minFilter),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,this.wrapS),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,this.wrapT),this},t.prototype.texImage=function(t,e,i){for(var r=this.gl,n=this.faces,a=0;6>a;a++)void 0!==e&&void 0!==i?r.texImage2D(n[a],0,this.dataFormat,e,i,this.border,this.dataFormat,this.dataType,t[a]):r.texImage2D(n[a],0,this.dataFormat,this.dataFormat,this.dataType,t[a]);return void 0!==e&&void 0!==i?(this.width=e,this.height=i):(this.width=t[0].width,this.height=t[0].height),this.isRenderable=!0,this},t.fromRes=function(e,i,r,n){var a=new t(e);return a.bind().texParam().texImage(i,r,n),a},t.fromSrc=function(t,e){},t.createRenderTexture=function(e,i,r){var n=new t(e);return n.bind().texParam().texImage([null,null,null,null,null,null],i,r),n},zen3d.TextureCube=t}(),function(){var t=function(){this.type="",this.color=16777215,this.map=null,this.opacity=1,this.transparent=!1,this.normalMap=null};t.prototype.checkMapInit=function(){return(!this.map||this.map.isRenderable)&&(!this.normalMap||this.normalMap.isRenderable)},zen3d.Material=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.type=zen3d.MATERIAL_TYPE.BASIC};zen3d.inherit(t,zen3d.Material),zen3d.BasicMaterial=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.type=zen3d.MATERIAL_TYPE.LAMBERT};zen3d.inherit(t,zen3d.Material),zen3d.LambertMaterial=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.type=zen3d.MATERIAL_TYPE.PHONE,this.specular=10};zen3d.inherit(t,zen3d.Material),zen3d.PhoneMaterial=t}(),function(){var t=function(e,i){t.superClass.constructor.call(this),this.geometry=e,this.material=i,this.type=zen3d.OBJECT_TYPE.MESH};zen3d.inherit(t,zen3d.Object3D),zen3d.Mesh=t}();