!function(){var t=function(i,e){t.superClass.constructor.call(this),this.type=zen3d.OBJECT_TYPE.CANVAS2D,this.geometry=new zen3d.Geometry,this.geometry.vertexSize=5,this.geometry.vertexFormat={a_Position:{size:3,normalized:!1,stride:5,offset:0},a_Uv:{size:2,normalized:!1,stride:5,offset:3}},this.geometry.usageType=zen3d.WEBGL_BUFFER_USAGE.DYNAMIC_DRAW,this.material=new zen3d.Canvas2DMaterial,this.width=void 0!==i?i:0,this.height=void 0!==e?e:0,this.sprites=[],this.drawArray=[],this.isScreenCanvas=!0,this.frustumCulled=!1,this.orthoCamera=new zen3d.Camera,this.orthoCamera.setOrtho(-this.width/2,this.width/2,-this.height/2,this.height/2,0,1),this.orthoCamera.viewMatrix.getInverse(this.orthoCamera.worldMatrix)};zen3d.inherit(t,zen3d.Object3D),t.prototype.add=function(t){this.children.push(t)},t.prototype.remove=function(t){var i=this.children.indexOf(t);i!==-1&&this.children.splice(i,1)},t.prototype.updateSprites=function(){for(var t=this.geometry,i=t.verticesArray,e=t.indicesArray,r=0,h=0,s=this.sprites,n=0;n<s.length;n++){var a,o,d=s[n],c=0,p=0,l=d.width,u=d.height,y=d.worldMatrix.elements,f=y[0],v=y[1],x=y[3],g=y[4],w=y[6]-this.width/2,m=this.height/2-y[7]-u;a=c,o=p,i[r++]=f*a+x*o+w,i[r++]=v*a+g*o+m,i[r++]=0,i[r++]=0,i[r++]=1,a=c+l,o=p,i[r++]=f*a+x*o+w,i[r++]=v*a+g*o+m,i[r++]=0,i[r++]=1,i[r++]=1,a=c+l,o=p+u,i[r++]=f*a+x*o+w,i[r++]=v*a+g*o+m,i[r++]=0,i[r++]=1,i[r++]=0,a=c,o=p+u,i[r++]=f*a+x*o+w,i[r++]=v*a+g*o+m,i[r++]=0,i[r++]=0,i[r++]=0;var z=r/5-4;e[h++]=z+0,e[h++]=z+1,e[h++]=z+2,e[h++]=z+2,e[h++]=z+3,e[h++]=z+0}i.length=r,e.length=h,t.dirty=!0,this.drawArray=[];for(var M,n=0;n<s.length;n++){var d=s[n];M!==d.texture?(this.drawArray.push({texture:d.texture,count:1}),M=d.texture):this.drawArray[this.drawArray.length-1].count++}},t.prototype.updateMatrix=function(){t.superClass.updateMatrix.call(this),this.sprites=[];for(var i=this.children,e=0,r=i.length;e<r;e++)this.cacheSprites(i[e]);for(var h=this.sprites,e=0,r=h.length;e<r;e++)h[e].updateMatrix();this.updateSprites()},t.prototype.cacheSprites=function(t){var i=this.sprites;i.push(t);for(var e=0,r=t.children.length;e<r;e++)this.cacheSprites(t.children[e])},zen3d.Canvas2D=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.type=zen3d.MATERIAL_TYPE.CANVAS2D,this.depthTest=!1};zen3d.inherit(t,zen3d.Material),zen3d.Canvas2DMaterial=t}(),function(){var t=function(){this.width=0,this.height=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.anchorX=0,this.anchorY=0,this.matrix=new zen3d.Matrix3,this.worldMatrix=new zen3d.Matrix3,this.children=new Array,this.parent=null,this.boundingBox=new zen3d.Box2};t.prototype.add=function(t){this.children.push(t),t.parent=this},t.prototype.remove=function(t){var i=this.children.indexOf(t);i!==-1&&this.children.splice(i,1),t.parent=null},t.prototype.getObjectByName=function(t){return this.getObjectByProperty("name",t)},t.prototype.getObjectByProperty=function(t,i){if(this[t]===i)return this;for(var e=0,r=this.children.length;e<r;e++){var h=this.children[e],s=h.getObjectByProperty(t,i);if(void 0!==s)return s}},t.prototype.updateMatrix=function(){var t=this.matrix.transform(this.x,this.y,this.scaleX,this.scaleY,this.rotation,this.anchorX*this.width,this.anchorY*this.height);if(this.worldMatrix.copy(t),this.parent){var i=this.parent.worldMatrix;this.worldMatrix.premultiply(i)}for(var e=this.children,r=0,h=e.length;r<h;r++)e[r].updateMatrix()},t.prototype.computeBoundingBox=function(){this.boundingBox.set(this.x,this.y,this.x+this.width,this.y+this.height)},zen3d.Object2D=t}(),function(){var t=function(){t.superClass.constructor.call(this),this.texture=null};zen3d.inherit(t,zen3d.Object2D),zen3d.Sprite2D=t}();